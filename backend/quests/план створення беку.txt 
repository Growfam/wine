backend/
‚îú‚îÄ‚îÄ quests/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
        --- analytics.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_quest.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ daily_bonus.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flex_rewards.py
        --- transaction.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wallet.py
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_controller.py
        --- analytics_controller.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ daily_controller.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flex_controller.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks_controller.py
        --- user_controller.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wallet_controller.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ verification_controller.py
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
        --- analytics_routes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_routes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ daily_routes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flex_routes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks_routes.py
        --- user_routes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wallet_routes.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ verification_routes.py
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram_service.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reward_calculator.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verification_service.py
        --- transaction_service.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ton_connect_service.py
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
        --- cache.py
‚îÇ       ‚îú‚îÄ‚îÄ validators.py
‚îÇ       ‚îú‚îÄ‚îÄ decorators.py
‚îÇ       ‚îî‚îÄ‚îÄ constants.py

üìã –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö API Endpoints –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É

Auth endpoints:
POST /api/auth/validate-telegram - –í–∞–ª—ñ–¥–∞—Ü—ñ—è Telegram Web App –¥–∞–Ω–∏—Ö
POST /api/auth/refresh-token - –û–Ω–æ–≤–ª–µ–Ω–Ω—è JWT —Ç–æ–∫–µ–Ω—É

User endpoints:
GET  /api/user/:userId - –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≤–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
GET  /api/user/:userId/balance - –û—Ç—Ä–∏–º–∞—Ç–∏ –±–∞–ª–∞–Ω—Å–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
POST /api/user/:userId/update-balance - –û–Ω–æ–≤–∏—Ç–∏ –±–∞–ª–∞–Ω—Å–∏ (–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π)
GET  /api/user/:userId/stats - –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
GET  /api/user/:userId/settings - –û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
POST /api/user/:userId/settings - –û–Ω–æ–≤–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

Wallet endpoints:
GET  /api/wallet/status/:userId - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≥–∞–º–∞–Ω—Ü—è
POST /api/wallet/connect/:userId - –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å
POST /api/wallet/disconnect/:userId - –í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å
POST /api/wallet/verify/:userId - –í–µ—Ä–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å

Flex endpoints:
GET  /api/flex/balance/:userId - –û—Ç—Ä–∏–º–∞—Ç–∏ –±–∞–ª–∞–Ω—Å FLEX —Ç–æ–∫–µ–Ω—ñ–≤
POST /api/flex/claim-reward/:userId/:level - –û—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É –∑–∞ —Ä—ñ–≤–µ–Ω—å
GET  /api/flex/history/:userId - –Ü—Å—Ç–æ—Ä—ñ—è –æ—Ç—Ä–∏–º–∞–Ω—å –≤–∏–Ω–∞–≥–æ—Ä–æ–¥
POST /api/flex/check-levels/:userId - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ä—ñ–≤–Ω—ñ

Daily bonus endpoints:
GET  /api/daily/status/:userId - –°—Ç–∞—Ç—É—Å —â–æ–¥–µ–Ω–Ω–æ–≥–æ –±–æ–Ω—É—Å—É
POST /api/daily/claim/:userId - –û—Ç—Ä–∏–º–∞—Ç–∏ —â–æ–¥–µ–Ω–Ω–∏–π –±–æ–Ω—É—Å
GET  /api/daily/history/:userId - –Ü—Å—Ç–æ—Ä—ñ—è –æ—Ç—Ä–∏–º–∞–Ω—å
POST /api/daily/calculate-reward/:userId - –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É –¥–ª—è –¥–Ω—è

Tasks endpoints:
GET  /api/tasks/list/:userId?type=all - –°–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å
POST /api/tasks/start/:userId/:taskId - –ü–æ—á–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è
POST /api/tasks/verify/:userId/:taskId - –í–µ—Ä–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
POST /api/tasks/complete/:userId/:taskId - –ó–∞–≤–µ—Ä—à–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è
POST /api/tasks/claim/:userId/:taskId - –û—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É

Verification endpoints:
POST /api/verify/telegram/:userId - –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è Telegram –ø—ñ–¥–ø–∏—Å–∫–∏
GET  /api/verify/check-bot/:userId - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞
POST /api/verify/social/:userId/:platform - –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂
Analytics endpoint:

POST /api/analytics/event - –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏—Ö –ø–æ–¥—ñ–π



–ï–¢–ê–ü 1: –ë–∞–∑–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: telegramValidator.js, api.js

–°—Ç–≤–æ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ backend/quests
–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Telegram auth –≤–∞–ª—ñ–¥–∞—Ü—ñ—é (HMAC-SHA256)
JWT —Ç–æ–∫–µ–Ω–∏ –¥–ª—è —Å–µ—Å—ñ–π
–î–µ–∫–æ—Ä–∞—Ç–æ—Ä–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

python# models/user_quest.py - –º–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
# controllers/auth_controller.py - validate_telegram, refresh_token
# routes/auth_routes.py - /api/auth/*
–ï–¢–ê–ü 2: –ú–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –±–∞–ª–∞–Ω—Å–∏
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: store.js, services.js

–ú–æ–¥–µ–ª—å UserQuest –≤ Supabase
Endpoints –¥–ª—è –ø—Ä–æ—Ñ—ñ–ª—é —Ç–∞ –±–∞–ª–∞–Ω—Å—ñ–≤
–°–∏—Å—Ç–µ–º–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–ª–∞–Ω—Å—ñ–≤

python# controllers/user_controller.py - get_profile, get_balance
# routes/user_routes.py - /api/user/*
–ï–¢–ê–ü 3: –°–∏—Å—Ç–µ–º–∞ —â–æ–¥–µ–Ω–Ω–∏—Ö –±–æ–Ω—É—Å—ñ–≤
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: dailyBonus.js

–ú–æ–¥–µ–ª—å DailyBonus –∑ —ñ—Å—Ç–æ—Ä—ñ—î—é
–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ—Ä—ñ—è–º–∏ –¥–Ω—ñ–≤

python# models/daily_bonus.py - —Å—Ö–µ–º–∞ –≤ Supabase
# services/reward_calculator.py - –ª–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
# controllers/daily_controller.py - status, claim, history
# routes/daily_routes.py - /api/daily/*
–ï–¢–ê–ü 4: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è TON –≥–∞–º–∞–Ω—Ü—ñ–≤
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: walletChecker.js

–ú–æ–¥–µ–ª—å Wallet
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–¥—Ä–µ—Å
–ë–æ–Ω—É—Å –∑–∞ –ø–µ—Ä—à–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

python# models/wallet.py
# services/ton_connect_service.py
# controllers/wallet_controller.py
# routes/wallet_routes.py - /api/wallet/*
–ï–¢–ê–ü 5: –°–∏—Å—Ç–µ–º–∞ FLEX —Ç–æ–∫–µ–Ω—ñ–≤
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: flexEarn.js

–ú–æ–¥–µ–ª—å FlexRewards
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—ñ–≤ —á–µ—Ä–µ–∑ TON API
–©–æ–¥–µ–Ω–Ω—ñ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏

python# models/flex_rewards.py
# controllers/flex_controller.py - balance, claim, levels
# routes/flex_routes.py - /api/flex/*
–ï–¢–ê–ü 6: –ë–∞–∑–∞ –∑–∞–≤–¥–∞–Ω—å (Tasks)
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: tasksManager.js

–ú–æ–¥–µ–ª—å Task –∑ —Ç–∏–ø–∞–º–∏ (social, limited, partner)
CRUD –¥–ª—è –∑–∞–≤–¥–∞–Ω—å
–°—Ç–∞—Ç—É—Å–∏ —Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å

python# models/task.py
# controllers/tasks_controller.py - list, start, complete
# routes/tasks_routes.py - /api/tasks/*
–ï–¢–ê–ü 7: –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: taskVerification.js

Telegram –±–æ—Ç –¥–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
–¢–∞–π–º–µ—Ä–∏ –¥–ª—è —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂
–ß–µ—Ä–≥–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ–π

python# services/telegram_service.py - —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –±–æ—Ç–æ–º
# services/verification_service.py
# controllers/verification_controller.py
# routes/verification_routes.py - /api/verify/*
–ï–¢–ê–ü 8: –í–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ —Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: store.js, services.js

–ú–æ–¥–µ–ª—å Transaction
–ê—Ç–æ–º–∞—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –±–∞–ª–∞–Ω—Å–∞–º–∏
–Ü—Å—Ç–æ—Ä—ñ—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π

python# models/transaction.py
# services/transaction_service.py
# –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ–≤ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
–ï–¢–ê–ü 9: –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: services.js (AnalyticsService)

–ú–æ–¥–µ–ª—å Analytics
–ó–±—ñ—Ä –ø–æ–¥—ñ–π
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

python# models/analytics.py
# controllers/analytics_controller.py
# routes/analytics_routes.py - /api/analytics/*
–ï–¢–ê–ü 10: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ç–∞ –±–µ–∑–ø–µ–∫–∞
–§–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç—É: api.js, constants.js

Rate limiting
–ö–µ—à—É–≤–∞–Ω–Ω—è (Redis)
–í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
–õ–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

python# utils/validators.py - —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
# utils/cache.py - Redis —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
# middleware/rate_limiter.py
# middleware/logger.py
üîê –í–∞–∂–ª–∏–≤—ñ –º–æ–º–µ–Ω—Ç–∏ –±–µ–∑–ø–µ–∫–∏

Telegram –≤–∞–ª—ñ–¥–∞—Ü—ñ—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ HMAC-SHA256
JWT —Ç–æ–∫–µ–Ω–∏ - –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó, refresh —Ç–æ–∫–µ–Ω–∏
Rate limiting - –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –ø–æ IP —Ç–∞ userId
–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó - –≤—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –±–∞–ª–∞–Ω—Å–∞–º–∏ –∞—Ç–æ–º–∞—Ä–Ω—ñ
–í–∞–ª—ñ–¥–∞—Ü—ñ—è - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö

–≤—Å–µ –≤ .env  —Ç–∞ requirements

# –ë–∞–∑–æ–≤–∏–π requirements.txt - –ë–ï–ó Telegram Bot —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É
Flask==3.1.0
flask-cors==5.0.1
gunicorn==23.0.0
python-dotenv==1.1.0

# Supabase (–±–µ–∑ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤)
supabase==2.15.0
gotrue==2.12.0
postgrest==1.0.1
storage3==0.11.3

# –û—Å–Ω–æ–≤–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
PyJWT==2.10.1
requests==2.32.3
Werkzeug==3.1.3
Jinja2==3.1.6
click==8.1.8
itsdangerous==2.2.0
MarkupSafe==3.0.2
certifi==2025.1.31
charset-normalizer==3.4.1
idna==3.10
urllib3==2.3.0


# –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è (–±–∞–∑–æ–≤–∞)
cryptography==43.0.3
# Telegram Bot - –°–£–ú–Ü–°–ù–Ü –í–ï–†–°–Ü–á
python-telegram-bot==20.8

