# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö Supabase

## üìä –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å—å–æ–≥–æ —Ç–∞–±–ª–∏—Ü—å**: 17
- **–í—Å—å–æ–≥–æ –∫–æ–ª–æ–Ω–æ–∫**: 201
- **Primary Keys**: 17 (–≤—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ –º–∞—é—Ç—å PK)
- **Foreign Keys**: 19 –∑–≤'—è–∑–∫—ñ–≤
- **RLS –ø–æ–ª—ñ—Ç–∏–∫**: 77 –ø–æ–ª—ñ—Ç–∏–∫

## üîó –ö–∞—Ä—Ç–∞ –∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏

### –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è: `winix`
- `direct_bonuses` ‚Üí `winix` (referrer_id, referee_id)
- `draw_participants` ‚Üí `winix` (user_id)
- `percentage_rewards` ‚Üí `winix` (user_id, referral_id)
- `raffle_participants` ‚Üí `winix` (telegram_id)
- `referral_activities` ‚Üí `winix` (user_id)
- `referrals` ‚Üí `winix` (referrer_id, referee_id)
- `transactions` ‚Üí `winix` (telegram_id)
- `user_badges` ‚Üí `winix` (user_id)
- `user_tasks` ‚Üí `winix` (user_id)
- `winix` ‚Üí `winix` (referrer_id - —Å–∞–º–æ–ø–æ—Å–∏–ª–∞–Ω–Ω—è)

### –Ü–Ω—à—ñ –∑–≤'—è–∑–∫–∏
- `draw_participants` ‚Üí `draws`
- `raffle_participants` ‚Üí `raffles`
- `raffle_winners` ‚Üí `raffles`
- `transactions` ‚Üí `raffles`
- `user_progress` ‚Üí `tasks`

---

## üìã –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—å

### 1. `daily_bonuses` (8 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
telegram_id: varchar(50) NOT NULL
bonus_type: varchar(20) NOT NULL DEFAULT 'daily'
amount: numeric NOT NULL
day_in_cycle: integer NOT NULL DEFAULT 1
claimed_date: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
created_at: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
token_amount: integer NOT NULL
```

### 2. `direct_bonuses` (5 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('direct_bonuses_id_seq')
referrer_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
referee_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
amount: integer DEFAULT 50
created_at: timestamp without time zone DEFAULT CURRENT_TIMESTAMP
```

### 3. `draw_participants` (6 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('draw_participants_id_seq')
draw_id: integer [FK ‚Üí draws.id] NOT NULL (–¥—É–±–ª—é—î—Ç—å—Å—è 2 —Ä–∞–∑–∏)
user_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
is_winner: boolean
prize_amount: integer
```

### 4. `draws` (3 –∫–æ–ª–æ–Ω–∫–∏)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('draws_id_seq')
name: varchar(100) NOT NULL
date: timestamp without time zone NOT NULL
```

### 5. `percentage_rewards` (8 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('percentage_rewards_id_seq')
user_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
referral_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
level: integer NOT NULL
rate: double precision NOT NULL
base_amount: integer NOT NULL
reward_amount: integer NOT NULL
created_at: timestamp without time zone DEFAULT CURRENT_TIMESTAMP
```

### 6. `raffle_participants` (9 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
telegram_id: text [FK ‚Üí winix.telegram_id] NOT NULL
raffle_id: uuid [FK ‚Üí raffles.id] NOT NULL
entry_count: integer DEFAULT 1
created_at: timestamp with time zone DEFAULT now()
is_winner: boolean
prize_amount: numeric
prize_claimed: boolean
status: text DEFAULT 'active'
```

### 7. `raffle_winners` (11 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT gen_random_uuid()
raffle_id: uuid [FK ‚Üí raffles.id] NOT NULL
telegram_id: text NOT NULL
place: integer NOT NULL
prize_amount: numeric NOT NULL
prize_currency: text DEFAULT 'WINIX'
win_time: timestamp with time zone DEFAULT now()
notification_sent: boolean
reward_claimed: boolean
created_at: timestamp with time zone DEFAULT now()
created_by: text
```

### 8. `raffles` (29 –∫–æ–ª–æ–Ω–æ–∫) - –Ω–∞–π–±—ñ–ª—å—à–∞ —Ç–∞–±–ª–∏—Ü—è
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
created_at: timestamp with time zone DEFAULT now()
title: text NOT NULL DEFAULT 'Jackpot Giw'
description: text DEFAULT '250$ —ñ 550K $Winix'
prize: text NOT NULL
raffle_type: text NOT NULL
start_time: timestamp with time zone DEFAULT now()
end_time: timestamp with time zone NOT NULL DEFAULT '2025-04-23 12:00:00+00'
status: text DEFAULT 'active'
participants_count: integer
entry_fee: integer DEFAULT 1
prize_amount: numeric DEFAULT 550
prize_currency: text DEFAULT 'WINIX'
winners_count: integer DEFAULT 1
is_daily: boolean
image_url: text
prize_distribution: jsonb DEFAULT '{}'
created_by: text
updated_at: timestamp with time zone DEFAULT now()
jackpot_mode: boolean DEFAULT true
participation_reward: numeric
participation_reward_currency: text DEFAULT '$Winix'
total_winix_pool: numeric
completed_at: timestamp with time zone
historical: boolean
archived: boolean
total_distributed: numeric
rewards_processed: boolean
rewards_processed_at: timestamp without time zone
```

### 9. `referral_activities` (7 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('referral_activities_id_seq')
user_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
draws_participation: integer
invited_referrals: integer
is_active: boolean
reason_for_activity: varchar(50)
last_updated: timestamp without time zone DEFAULT CURRENT_TIMESTAMP
```

### 10. `referrals` (5 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('referrals_id_seq')
referrer_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
referee_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
level: integer DEFAULT 1
created_at: timestamp without time zone DEFAULT CURRENT_TIMESTAMP
```

### 11. `staking_sessions` (14 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
user_id: text NOT NULL
amount_staked: numeric NOT NULL
staking_days: integer NOT NULL
reward_percent: double precision NOT NULL
started_at: timestamp with time zone DEFAULT now()
ends_at: timestamp with time zone NOT NULL
is_active: boolean DEFAULT true
cancelled_early: boolean
final_amount_paid: numeric
created_at: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
updated_at: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
telegram_id: text
completed_at: timestamp without time zone
```

### 12. `tasks` (23 –∫–æ–ª–æ–Ω–∫–∏)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
title: varchar(255) NOT NULL
description: text NOT NULL
task_type: varchar(50) NOT NULL
reward_type: varchar(50) NOT NULL
reward_amount: numeric NOT NULL
target_value: integer NOT NULL DEFAULT 1
action_type: varchar(50) NOT NULL
action_url: text
action_label: varchar(100)
status: varchar(20) NOT NULL DEFAULT 'active'
start_date: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
end_date: timestamp with time zone
created_at: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
updated_at: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
platforms: jsonb DEFAULT '[]'
tags: jsonb DEFAULT '[]'
difficulty: smallint NOT NULL DEFAULT 1
repeatable: boolean
cooldown_hours: integer DEFAULT 24
verification_type: varchar(20) DEFAULT 'manual'
created_by: varchar(50)
extra_data: jsonb
```

### 13. `transactions` (15 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
created_at: timestamp with time zone DEFAULT now()
telegram_id: text [FK ‚Üí winix.telegram_id] NOT NULL
type: text NOT NULL
amount: numeric NOT NULL
description: text
status: text DEFAULT 'completed'
staking_id: text
from_address: text
to_address: text
raffle_id: uuid [FK ‚Üí raffles.id]
previous_balance: numeric
transaction_group: uuid
updated_at: timestamp without time zone DEFAULT now()
previous_coins: numeric
```

### 14. `user_badges` (6 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('user_badges_id_seq')
user_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
badge_type: varchar(20) [UNIQUE] NOT NULL
earned_at: timestamp without time zone DEFAULT CURRENT_TIMESTAMP
claimed: boolean
reward_amount: integer NOT NULL
```

### 15. `user_progress` (12 –∫–æ–ª–æ–Ω–æ–∫)
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
telegram_id: varchar(50) [UNIQUE] NOT NULL
task_id: uuid [FK ‚Üí tasks.id] NOT NULL
status: varchar(20) NOT NULL DEFAULT 'not_started'
progress_value: integer NOT NULL
max_progress: integer NOT NULL DEFAULT 100
start_date: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
completion_date: timestamp with time zone
last_updated: timestamp with time zone DEFAULT CURRENT_TIMESTAMP
verification_data: jsonb DEFAULT '{}'
reward_claimed: boolean
attempts: integer
```

### 16. `user_tasks` (9 –∫–æ–ª–æ–Ω–æ–∫)
```
id: integer [PRIMARY KEY] NOT NULL DEFAULT nextval('user_tasks_id_seq')
user_id: varchar(255) [FK ‚Üí winix.telegram_id] NOT NULL
task_type: varchar(30) [UNIQUE] NOT NULL
progress: integer
threshold: integer NOT NULL
completed: boolean
claimed: boolean
reward_amount: integer NOT NULL
last_updated: timestamp with time zone DEFAULT now()
```

### 17. `winix` (31 –∫–æ–ª–æ–Ω–∫–∞) - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
```
id: uuid [PRIMARY KEY] NOT NULL DEFAULT uuid_generate_v4()
created_at: timestamp with time zone DEFAULT now()
telegram_id: text [UNIQUE] NOT NULL
username: text
balance: numeric
coins: integer DEFAULT 3
referrer_id: text [FK ‚Üí winix.telegram_id]
newbie_bonus_claimed: boolean
participations_count: integer
badge_winner: boolean
badge_beginner: boolean
badge_rich: boolean
language: text DEFAULT 'uk'
avatar_id: text
avatar_url: text
password_hash: text
seed_phrase: text
notifications_enabled: boolean DEFAULT true
badge_winner_reward_claimed: boolean
badge_beginner_reward_claimed: boolean
badge_rich_reward_claimed: boolean
daily_bonuses: jsonb DEFAULT '{"current_day": 1, "claimed_days": [], "last_claimed_date": null}'
social_tasks: jsonb DEFAULT '{}'
referral_tasks: jsonb DEFAULT '{}'
page1_completed: boolean
wins_count: integer
staking_data: jsonb DEFAULT '{}'
staking_history: jsonb DEFAULT '[]'
seed_phrase_iv: text
updated_at: timestamp without time zone
referral_code: varchar(20)
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö

- **integer**: 38 –∫–æ–ª–æ–Ω–æ–∫
- **text**: 34 –∫–æ–ª–æ–Ω–∫–∏
- **character varying**: 27 –∫–æ–ª–æ–Ω–æ–∫
- **boolean**: 27 –∫–æ–ª–æ–Ω–æ–∫
- **timestamp with time zone**: 24 –∫–æ–ª–æ–Ω–∫–∏
- **uuid**: 14 –∫–æ–ª–æ–Ω–æ–∫
- **numeric**: 14 –∫–æ–ª–æ–Ω–æ–∫
- **timestamp without time zone**: 10 –∫–æ–ª–æ–Ω–æ–∫
- **jsonb**: 10 –∫–æ–ª–æ–Ω–æ–∫
- **double precision**: 2 –∫–æ–ª–æ–Ω–∫–∏
- **smallint**: 1 –∫–æ–ª–æ–Ω–∫–∞

---

## üîë –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

- `user_badges.badge_type` - UNIQUE
- `user_progress.telegram_id` - UNIQUE
- `user_tasks.task_type` - UNIQUE
- `winix.telegram_id` - UNIQUE

---

## üí° –í–∞–∂–ª–∏–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

1. **UUID vs Integer ID**: –ù–æ–≤—ñ—à—ñ —Ç–∞–±–ª–∏—Ü—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å UUID (daily_bonuses, raffles, transactions), —Å—Ç–∞—Ä—ñ—à—ñ - integer –∑ sequence
2. **Timestamp —Ç–∏–ø–∏**: –ó–º—ñ—à–∞–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `with time zone` —Ç–∞ `without time zone`
3. **JSONB –∫–æ–ª–æ–Ω–∫–∏**: –ê–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö (winix, raffles, tasks)
4. **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ —Ä–æ–ª—å winix**: –ú–∞–π–∂–µ –≤—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ –ø–æ—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ `winix.telegram_id`
5. **–î—É–±–ª—ñ–∫–∞—Ç FK**: –í `draw_participants` —î –¥—É–±–ª—ñ–∫–∞—Ç –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –∫–ª—é—á–∞ `draw_id`

---

## üîê RLS (Row Level Security) –ø–æ–ª—ñ—Ç–∏–∫–∏

### –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ RLS:
- **–í—Å—å–æ–≥–æ –ø–æ–ª—ñ—Ç–∏–∫**: 77
- **–¢–∞–±–ª–∏—Ü—å –∑ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏**: 17 (–≤—Å—ñ —Ç–∞–±–ª–∏—Ü—ñ)
- **–¢–∏–ø–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π**:
  - ALL: 26 –ø–æ–ª—ñ—Ç–∏–∫
  - SELECT: 14 –ø–æ–ª—ñ—Ç–∏–∫
  - INSERT: 14 –ø–æ–ª—ñ—Ç–∏–∫
  - UPDATE: 14 –ø–æ–ª—ñ—Ç–∏–∫
  - DELETE: 9 –ø–æ–ª—ñ—Ç–∏–∫

### –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –ø–æ–ª—ñ—Ç–∏–∫ –ø–æ —Ç–∞–±–ª–∏—Ü—è—Ö:

#### 1. `daily_bonuses` (5 –ø–æ–ª—ñ—Ç–∏–∫)
- **Enable insert for service role** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É –¥–ª—è public
- **daily_bonuses_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ –¥–ª—è admin —Ä–æ–ª—ñ
- **daily_bonuses_select_policy** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å—ñ—Ö
- **daily_bonuses_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ –¥–ª—è service_role
- **daily_bonuses_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ –¥–ª—è admin —Ä–æ–ª—ñ

#### 2. `direct_bonuses` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å—ñ—Ö
- **direct_bonuses_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 3. `draw_participants` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations on draw_participants** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **draw_participants_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 4. `draws` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations on draws** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **draws_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 5. `percentage_rewards` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **percentage_rewards_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 6. `raffle_participants` (8 –ø–æ–ª—ñ—Ç–∏–∫) - –Ω–∞–π–±—ñ–ª—å—à–µ –ø–æ–ª—ñ—Ç–∏–∫
- **Enable insert for authenticated users** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É
- **Enable read access for all users** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **Enable update for all users** (UPDATE): –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- **raffle_participants_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin
- **raffle_participants_insert_policy** (INSERT): –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ telegram_id –∞–±–æ admin/winix_system
- **raffle_participants_select_policy** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **raffle_participants_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ –¥–ª—è service_role
- **raffle_participants_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin

#### 7. `raffle_winners` (5 –ø–æ–ª—ñ—Ç–∏–∫)
- **raffle_winners_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **raffle_winners_insert_policy** (INSERT): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin
- **raffle_winners_select_policy** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **raffle_winners_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **raffle_winners_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin

#### 8. `raffles` (8 –ø–æ–ª—ñ—Ç–∏–∫)
- **Enable insert for authenticated users** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É
- **Enable read access for all users** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **Enable update for all users** (UPDATE): –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- **raffles_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **raffles_insert_policy** (INSERT): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin
- **raffles_select_policy** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **raffles_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **raffles_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin

#### 9. `referral_activities` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations on referral_activities** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **referral_activities_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 10. `referrals` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **referrals_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 11. `staking_sessions` (8 –ø–æ–ª—ñ—Ç–∏–∫)
- **Enable read access for all users** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **Enable users to insert their own staking sessions** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É
- **Enable users to update their own staking sessions** (UPDATE): –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- **staking_sessions_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **staking_sessions_insert_policy** (INSERT): –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ user_id/telegram_id –∞–±–æ admin/winix_system
- **staking_sessions_select_policy** (SELECT): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin
- **staking_sessions_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **staking_sessions_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin/winix_system

#### 12. `tasks` (5 –ø–æ–ª—ñ—Ç–∏–∫)
- **Allow insert for service role** (INSERT): –¢—ñ–ª—å–∫–∏ service_role
- **tasks_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **tasks_select_policy** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **tasks_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **tasks_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ admin

#### 13. `transactions` (8 –ø–æ–ª—ñ—Ç–∏–∫)
- **Enable insert for authenticated users** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É
- **Enable read access for all users** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **Enable update for all users** (UPDATE): –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- **transactions_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **transactions_insert_policy** (INSERT): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin
- **transactions_select_policy** (SELECT): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin
- **transactions_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **transactions_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ admin

#### 14. `user_badges` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **user_badges_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 15. `user_progress` (5 –ø–æ–ª—ñ—Ç–∏–∫)
- **user_progress_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **user_progress_insert_policy** (INSERT): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin
- **user_progress_select_policy** (SELECT): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin
- **user_progress_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **user_progress_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin

#### 16. `user_tasks` (2 –ø–æ–ª—ñ—Ç–∏–∫–∏)
- **Allow all operations on user_tasks** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- **user_tasks_policy** (ALL): –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é

#### 17. `winix` (9 –ø–æ–ª—ñ—Ç–∏–∫) - –Ω–∞–π–±—ñ–ª—å—à–µ –ø–æ–ª—ñ—Ç–∏–∫
- **Enable insert access for authenticated users** (INSERT): –î–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∫—É
- **Enable read access for all users** (SELECT): –í—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø
- **Enable update for all users** (UPDATE): –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- **user_policy** (ALL): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ (telegram_id = auth.uid())
- **winix_delete_policy** (DELETE): –¢—ñ–ª—å–∫–∏ admin
- **winix_insert_policy** (INSERT): –¢—ñ–ª—å–∫–∏ winix_system –∞–±–æ admin
- **winix_select_policy** (SELECT): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin
- **winix_service_policy** (ALL): –¢—ñ–ª—å–∫–∏ service_role
- **winix_update_policy** (UPDATE): –¢—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ admin

### –¢–∏–ø–∏ –¥–æ—Å—Ç—É–ø—É –≤ –ø–æ–ª—ñ—Ç–∏–∫–∞—Ö:

1. **–ü–æ–≤–Ω–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø**: direct_bonuses, draw_participants, draws, percentage_rewards, referral_activities, referrals, user_badges, user_tasks
2. **–û–±–º–µ–∂–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø (–≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ)**: staking_sessions, transactions, user_progress, winix
3. **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å**: daily_bonuses, tasks (–±—ñ–ª—å—à—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ–π –ø–æ—Ç—Ä–µ–±—É—é—Ç—å admin —Ä–æ–ª—ñ)
4. **–ó–º—ñ—à–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø**: raffle_participants, raffle_winners, raffles (—á–∏—Ç–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–µ, –∑–∞–ø–∏—Å –æ–±–º–µ–∂–µ–Ω–∏–π)

### –ö–ª—é—á–æ–≤—ñ —Ä–æ–ª—ñ –≤ —Å–∏—Å—Ç–µ–º—ñ:
- **public**: –±–∞–∑–æ–≤–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å—ñ—Ö
- **admin**: –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
- **service_role**: —Å–∏—Å—Ç–µ–º–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
- **winix_system**: —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ —Ä–æ–ª—å –¥–ª—è —Å–∏—Å—Ç–µ–º–∏ Winix

### –£–º–æ–≤–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:
- `auth.uid()`: ID –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `auth.jwt()`: JWT —Ç–æ–∫–µ–Ω –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ claims
- `telegram_id = auth.uid()`: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–ª–∞—Å–Ω–∏–∫–∞ –¥–∞–Ω–∏—Ö
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ JWT claims

---

## üîß –°–∏—Å—Ç–µ–º–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –æ–±'—î–∫—Ç—ñ–≤:
–í—Å—ñ 17 —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π:
- **–¢–∏–ø –æ–±'—î–∫—Ç–∞**: `pg_class` - –≤—Å—ñ –æ–±'—î–∫—Ç–∏ —î —Ç–∞–±–ª–∏—Ü—è–º–∏ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –∫–∞—Ç–∞–ª–æ–∑—ñ PostgreSQL
- **–¢–∏–ø –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ**: `n` (normal) - –∑–≤–∏—á–∞–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å, –æ–∑–Ω–∞—á–∞—î —â–æ –æ–±'—î–∫—Ç –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É

### –¢–∏–ø–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –≤ PostgreSQL:
- **n (normal)** - –∑–≤–∏—á–∞–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å, –æ–±'—î–∫—Ç –Ω–µ –º–æ–∂–µ —ñ—Å–Ω—É–≤–∞—Ç–∏ –±–µ–∑ –∑–∞–ª–µ–∂–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞
- **a (auto)** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤
- **i (internal)** - –≤–Ω—É—Ç—Ä—ñ—à–Ω—è –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –æ–¥–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞
- **p (pin)** - –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å, –æ–±'—î–∫—Ç –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–∏–π
- **e (extension)** - –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### –°–∏—Å—Ç–µ–º–Ω—ñ –∫–∞—Ç–∞–ª–æ–≥–∏ PostgreSQL:
- **pg_class** - –∫–∞—Ç–∞–ª–æ–≥ –≤—Å—ñ—Ö —Ç–∞–±–ª–∏—Ü—å, —ñ–Ω–¥–µ–∫—Å—ñ–≤, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π —Ç–∞ —ñ–Ω—à–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
- –í—Å—ñ –Ω–∞—à—ñ —Ç–∞–±–ª–∏—Ü—ñ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ –≤ —Ü—å–æ–º—É –∫–∞—Ç–∞–ª–æ–∑—ñ —ñ –º–∞—é—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—É –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –Ω—å–æ–≥–æ

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å:
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑–∞–ø–∏—Ç–∏:
- –¢—Ä–∏–≥–µ—Ä–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—ó
- –Ü–Ω–¥–µ–∫—Å–∏ —Ç–∞ —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É (GRANTS)
- Storage –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
- TOAST –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
- –ü—Ä–∞–≤–∏–ª–∞ (RULES)
- –ü—É–±–ª—ñ–∫–∞—Ü—ñ—ó –¥–ª—è logical replication
- –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è (EXTENSIONS)