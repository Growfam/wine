/**
 * staking-buttons-fix.js
 * –£–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∞–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É —É WINIX.
 */

(function() {
    console.log("üîí –ó–∞–ø—É—Å–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∞–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É");

    // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω—ñ–π —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
    if (window.WinixStakingButtonsFixed) {
        console.log("‚ö†Ô∏è –°–∏—Å—Ç–µ–º—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∞–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É –≤–∂–µ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ");
        return;
    }

    // –ü–æ–∑–Ω–∞—á–∞—î–º–æ, —â–æ —Å–∏—Å—Ç–µ–º—É –≤–∂–µ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
    window.WinixStakingButtonsFixed = true;

    // –ì–ª–æ–±–∞–ª—å–Ω–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä–Ω–∏–º –∫–ª—ñ–∫–æ–º
    let isProcessingStakingAction = false;

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –∑ –µ–ª–µ–º–µ–Ω—Ç–∞ —Ç–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ
    function setupCleanButton(buttonId, clickHandler) {
        // –í–∏–∫–æ–Ω—É—î–º–æ –ø—ñ—Å–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DOM
        function initButton() {
            const button = document.getElementById(buttonId);
            if (!button) return;

            console.log(`üîÑ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏ ${buttonId} –∑ —î–¥–∏–Ω–∏–º –æ–±—Ä–æ–±–Ω–∏–∫–æ–º`);

            // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–ª–æ–Ω –∫–Ω–æ–ø–∫–∏ –±–µ–∑ –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤
            const newButton = button.cloneNode(true);
            button.parentNode.replaceChild(newButton, button);

            // –î–æ–¥–∞—î–º–æ —î–¥–∏–Ω–∏–π –æ–±—Ä–æ–±–Ω–∏–∫
            newButton.addEventListener('click', clickHandler);
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ DOM
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initButton);
        } else {
            initButton();
        }

        // –ü–æ–≤—Ç–æ—Ä–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ AJAX
        document.addEventListener('winix-initialized', initButton);
    }

    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
    function handleAddToStakeButton() {
        // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—é
        if (isProcessingStakingAction) {
            console.log("üö´ –î—ñ—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É –≤–∂–µ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è");
            return;
        }

        isProcessingStakingAction = true;
        console.log("üíº –í–∏–∫–ª–∏–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É");

        try {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω
            window.createInputModal('–í–≤–µ–¥—ñ—Ç—å —Å—É–º—É –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É:', function(amount) {
                console.log(`üíº –û—Ç—Ä–∏–º–∞–Ω–æ —Å—É–º—É –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è: ${amount}`);

                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
                let hasActiveStaking = false;
                if (window.WinixCore && window.WinixCore.Staking) {
                    hasActiveStaking = window.WinixCore.Staking.hasActiveStaking();
                } else if (window.stakingSystem) {
                    hasActiveStaking = window.stakingSystem.hasActiveStaking();
                }

                if (!hasActiveStaking) {
                    window.simpleAlert("–£ –≤–∞—Å –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                    return;
                }

                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –±–∞–ª–∞–Ω—Å
                let balance = 0;
                if (window.WinixCore && window.WinixCore.Balance) {
                    balance = window.WinixCore.Balance.getTokens();
                } else if (window.balanceSystem) {
                    balance = window.balanceSystem.getTokens();
                } else {
                    balance = parseFloat(localStorage.getItem('userTokens') || '0');
                }

                if (amount > balance) {
                    window.simpleAlert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ—à—Ç—ñ–≤. –í–∞—à –±–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} $WINIX`, true);
                    return;
                }

                // –î–æ–¥–∞—î–º–æ –∫–æ—à—Ç–∏ –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
                if (window.WinixCore && window.WinixCore.Staking) {
                    const result = window.WinixCore.Staking.addToStaking(amount);
                    if (result.success) {
                        window.simpleAlert(`–î–æ–¥–∞–Ω–æ ${amount.toFixed(2)} $WINIX –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É`, false, function() {
                            // –û–Ω–æ–≤–ª—é—î–º–æ UI –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è
                            if (window.WinixCore && window.WinixCore.UI) {
                                window.WinixCore.UI.updateStakingDisplay();
                                window.WinixCore.UI.updateBalanceDisplay();
                            }
                        });
                    } else {
                        window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                    }
                } else if (window.stakingSystem) {
                    const result = window.stakingSystem.addToStaking(amount);
                    if (result.success) {
                        window.simpleAlert(`–î–æ–¥–∞–Ω–æ ${amount.toFixed(2)} $WINIX –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É`, false, function() {
                            // –û–Ω–æ–≤–ª—é—î–º–æ UI –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è
                            window.stakingSystem.updateStakingDisplay();
                            if (window.balanceSystem) {
                                window.balanceSystem.updateDisplay();
                            }
                        });
                    } else {
                        window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                    }
                } else {
                    window.simpleAlert("–ü–æ–º–∏–ª–∫–∞: —Å–∏—Å—Ç–µ–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ", true);
                }
            });
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –∫–Ω–æ–ø–∫–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É:", error);
            window.simpleAlert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.", true);
        } finally {
            // –°–∫–∏–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–µ–≤–µ–ª–∏–∫–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É
            setTimeout(function() {
                isProcessingStakingAction = false;
            }, 500);
        }
    }

    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É
    function handleCancelStakingButton() {
        // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—é
        if (isProcessingStakingAction) {
            console.log("üö´ –î—ñ—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É –≤–∂–µ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è");
            return;
        }

        isProcessingStakingAction = true;
        console.log("üíº –û–±—Ä–æ–±–∫–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É");

        try {
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
            let hasActiveStaking = false;
            if (window.WinixCore && window.WinixCore.Staking) {
                hasActiveStaking = window.WinixCore.Staking.hasActiveStaking();
            } else if (window.stakingSystem) {
                hasActiveStaking = window.stakingSystem.hasActiveStaking();
            }

            if (!hasActiveStaking) {
                window.simpleAlert("–£ –≤–∞—Å –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                return;
            }

            if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥? –ë—É–¥–µ —É—Ç—Ä–∏–º–∞–Ω–æ 20% –≤—ñ–¥ —Å—É–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É —è–∫ —à—Ç—Ä–∞—Ñ.")) {
                if (window.WinixCore && window.WinixCore.Staking) {
                    const result = window.WinixCore.Staking.cancelStaking();
                    if (result.success) {
                        window.simpleAlert(result.message || "–°—Ç–µ–π–∫—ñ–Ω–≥ —É—Å–ø—ñ—à–Ω–æ —Å–∫–∞—Å–æ–≤–∞–Ω–æ", false, function() {
                            window.location.href = "wallet.html";
                        });
                    } else {
                        window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                    }
                } else if (window.stakingSystem) {
                    const result = window.stakingSystem.cancelStaking();
                    if (result.success) {
                        window.simpleAlert(result.message || "–°—Ç–µ–π–∫—ñ–Ω–≥ —É—Å–ø—ñ—à–Ω–æ —Å–∫–∞—Å–æ–≤–∞–Ω–æ", false, function() {
                            window.location.href = "wallet.html";
                        });
                    } else {
                        window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                    }
                } else {
                    window.simpleAlert("–ü–æ–º–∏–ª–∫–∞: —Å–∏—Å—Ç–µ–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ", true);
                }
            }
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –∫–Ω–æ–ø–∫–∏ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É:", error);
            window.simpleAlert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.", true);
        } finally {
            // –°–∫–∏–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–µ–≤–µ–ª–∏–∫–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É
            setTimeout(function() {
                isProcessingStakingAction = false;
            }, 500);
        }
    }

    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ó–∞—Å—Ç–µ–π–∫–∞—Ç–∏"
    function handleStakeButton() {
        // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—é
        if (isProcessingStakingAction) {
            console.log("üö´ –î—ñ—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É –≤–∂–µ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è");
            return;
        }

        isProcessingStakingAction = true;
        console.log("üíº –û–±—Ä–æ–±–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É");

        try {
            // –û—Ç—Ä–∏–º—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –ø–æ–ª—ñ–≤
            const amountInput = document.getElementById('staking-amount');
            const periodSelect = document.getElementById('staking-period');

            if (!amountInput || !periodSelect) {
                window.simpleAlert("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –ø–æ–ª—è –¥–ª—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                return;
            }

            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount <= 0) {
                window.simpleAlert("–í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É —Å—É–º—É", true);
                return;
            }

            const period = parseInt(periodSelect.value);
            if (isNaN(period) || ![7, 14, 28].includes(period)) {
                window.simpleAlert("–í–∏–±–µ—Ä—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                return;
            }

            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
            let hasActiveStaking = false;
            if (window.WinixCore && window.WinixCore.Staking) {
                hasActiveStaking = window.WinixCore.Staking.hasActiveStaking();
            } else if (window.stakingSystem) {
                hasActiveStaking = window.stakingSystem.hasActiveStaking();
            }

            if (hasActiveStaking) {
                window.simpleAlert("–£ –≤–∞—Å –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∏–π —Å—Ç–µ–π–∫—ñ–Ω–≥", true);
                return;
            }

            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –±–∞–ª–∞–Ω—Å
            let balance = 0;
            if (window.WinixCore && window.WinixCore.Balance) {
                balance = window.WinixCore.Balance.getTokens();
            } else if (window.balanceSystem) {
                balance = window.balanceSystem.getTokens();
            }

            if (amount > balance) {
                window.simpleAlert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ—à—Ç—ñ–≤. –í–∞—à –±–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} $WINIX`, true);
                return;
            }

            // –°—Ç–≤–æ—Ä—é—î–º–æ —Å—Ç–µ–π–∫—ñ–Ω–≥
            if (window.WinixCore && window.WinixCore.Staking) {
                const result = window.WinixCore.Staking.createStaking(amount, period);
                if (result.success) {
                    window.simpleAlert("–°—Ç–µ–π–∫—ñ–Ω–≥ —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!", false, function() {
                        window.location.href = "staking-details.html";
                    });
                } else {
                    window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                }
            } else if (window.stakingSystem) {
                const result = window.stakingSystem.createStaking(amount, period);
                if (result.success) {
                    window.simpleAlert("–°—Ç–µ–π–∫—ñ–Ω–≥ —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!", false, function() {
                        window.location.href = "staking-details.html";
                    });
                } else {
                    window.simpleAlert(result.message || "–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                }
            } else {
                window.simpleAlert("–ü–æ–º–∏–ª–∫–∞: —Å–∏—Å—Ç–µ–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ", true);
            }
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –∫–Ω–æ–ø–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–µ–π–∫—ñ–Ω–≥—É:", error);
            window.simpleAlert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.", true);
        } finally {
            // –°–∫–∏–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –Ω–µ–≤–µ–ª–∏–∫–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É
            setTimeout(function() {
                isProcessingStakingAction = false;
            }, 500);
        }
    }

    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–µ—Ç–∞–ª—ñ —Å—Ç–µ–π–∫—ñ–Ω–≥—É"
    function handleDetailsButton() {
        console.log("üíº –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –¥–µ—Ç–∞–ª–µ–π —Å—Ç–µ–π–∫—ñ–Ω–≥—É");

        try {
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
            let hasActiveStaking = false;
            if (window.WinixCore && window.WinixCore.Staking) {
                hasActiveStaking = window.WinixCore.Staking.hasActiveStaking();
            } else if (window.stakingSystem) {
                hasActiveStaking = window.stakingSystem.hasActiveStaking();
            }

            if (!hasActiveStaking) {
                window.simpleAlert("–£ –≤–∞—Å –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–µ–π–∫—ñ–Ω–≥—É", true);
                return;
            }

            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–µ—Ç–∞–ª–µ–π —Å—Ç–µ–π–∫—ñ–Ω–≥—É
            window.location.href = "staking-details.html";
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –∫–Ω–æ–ø–∫–∏ –¥–µ—Ç–∞–ª–µ–π —Å—Ç–µ–π–∫—ñ–Ω–≥—É:", error);
            window.simpleAlert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.", true);
        }
    }

    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –≤—Å—ñ—Ö –∫–Ω–æ–ø–æ–∫ —Å—Ç–µ–π–∫—ñ–Ω–≥—É
    setupCleanButton('add-to-stake-button', handleAddToStakeButton);
    setupCleanButton('cancel-staking-button', handleCancelStakingButton);
    setupCleanButton('stake-button', handleStakeButton);
    setupCleanButton('details-button', handleDetailsButton);

    // –ï–∫—Å–ø–æ—Ä—Ç—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –º–æ–∂–ª–∏–≤–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —ñ–Ω—à–∏—Ö –º—ñ—Å—Ü—è—Ö
    window.WinixStakingButtons = {
        setupAddButton: function() { setupCleanButton('add-to-stake-button', handleAddToStakeButton); },
        setupCancelButton: function() { setupCleanButton('cancel-staking-button', handleCancelStakingButton); },
        setupStakeButton: function() { setupCleanButton('stake-button', handleStakeButton); },
        setupDetailsButton: function() { setupCleanButton('details-button', handleDetailsButton); }
    };

    console.log("‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É —Å–∏—Å—Ç–µ–º—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∞–º–∏ —Å—Ç–µ–π–∫—ñ–Ω–≥—É —É—Å–ø—ñ—à–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ");
})();